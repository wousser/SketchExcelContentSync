{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./node_modules/@skpm/dialog/lib/index.js","webpack://exports/./node_modules/@skpm/dialog/lib/message-box.js","webpack://exports/./node_modules/@skpm/dialog/lib/open-dialog.js","webpack://exports/./node_modules/@skpm/dialog/lib/save-dialog.js","webpack://exports/./node_modules/@skpm/dialog/lib/utils.js","webpack://exports/./node_modules/@skpm/fs/index.js","webpack://exports/./node_modules/@skpm/fs/utils.js","webpack://exports/./node_modules/@skpm/promise/index.js","webpack://exports/./node_modules/xlsx/xlsx.mjs","webpack://exports/./src/constants.js","webpack://exports/./src/sync-page.js","webpack://exports/external \"buffer\"","webpack://exports/external \"path\"","webpack://exports/external \"sketch\"","webpack://exports/external \"sketch/settings\"","webpack://exports/external \"sketch/ui\""],"names":["excelDivider","sketchSymbolDivider","artboardPrefix","translateLayerPrefix","module","exports","constants","require","UI","path","Settings","XLSX","document","sketch","getSelectedDocument","contentDictionary","languageOptions","selectedLanguage","syncCurrentPage","context","console","log","contentDocumentExists","contentFile","documentSettingForKey","loadData","populatePage","reloadInspector","message","syncAllPages","pages","page","name","selectContentFile","filePaths","dialog","showOpenDialog","properties","defaultPath","filters","extensions","length","setDocumentSettingForKey","fileType","extname","toLowerCase","loadExcelData","fs","existsSync","showLanguageSelectionPopup","contentFileName","basename","getInputFromUser","type","INPUT_TYPE","selection","possibleValues","err","value","xlsData","readFileSync","workbook","read","firstSheetName","SheetNames","worksheet","Sheets","excelJson","utils","sheet_to_json","range","defval","rowNumber","keyAndLanguageOptions","Object","keys","shift","language","push","currentArboardName","row","includes","String","onComplete","analyzeLayer","layers","layer","Types","Group","SymbolInstance","updateSymbolLayer","Text","updateTextLayer","Artboard","selectedPage","getParentArtboard","undefined","artboardAndLayerName","text","symbol","artboardAndSymbolName","overrides","override","property","layerNameAndOverride","layerNamesFromPath","layerNames","layerIDs","split","layerID","getLayerWithID","layerName","join"],"mappings":";;;;;;;;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;AClFA;AACA;;AAEA;AACA,kBAAkB,mBAAO,CAAC,qEAAe;AACzC,sBAAsB,mBAAO,CAAC,qEAAe;AAC7C,kBAAkB,mBAAO,CAAC,qEAAe;AACzC,sBAAsB,mBAAO,CAAC,qEAAe;AAC7C,kBAAkB,mBAAO,CAAC,qEAAe;AACzC,sBAAsB,mBAAO,CAAC,qEAAe;AAC7C;AACA;;;;;;;;;;;;ACXA;AACA,YAAY,mBAAO,CAAC,yDAAS;;AAE7B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;;;;;;;;;;;ACnIA;AACA,YAAY,mBAAO,CAAC,yDAAS;;AAE7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,iBAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,iBAAiB;AACtC;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;;;;;;;;;;;AClHA;AACA,YAAY,mBAAO,CAAC,yDAAS;;AAE7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;;AAEL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;;;;;;;;;;;AC3GA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;;;;;;;;;;;;;AC9DA;AACA;AACA,aAAa,mBAAO,CAAC,sBAAQ;AAC7B,YAAY,mBAAO,CAAC,iDAAS;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,mBAAmB,OAAO;AAC1B;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;;;;;;;;;;;ACpbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,sBAAsB,mBAAO,CAAC,iDAAS;AACvC;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC9JA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,kBAAkB;AAC/B;AACA,aAAa,kBAAkB;AAC/B;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA,+CAA+C,SAAS;AACxD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA,mBAAmB,iBAAiB;AACpC;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA,qCAAqC,SAAS;AAC9C;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;;AC9QA;AAAA,+L;;;;;;;;;;;ACAA,IAAIA,YAAY,GAAG,KAAnB;AACA,IA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","file":"__sync-page.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/sync-page.js\");\n","/* let's try to match the API from Electron's Dialog\n(https://github.com/electron/electron/blob/master/docs/api/dialog.md) */\n\nmodule.exports = {\n  showOpenDialog: require('./open-dialog').openDialog,\n  showOpenDialogSync: require('./open-dialog').openDialogSync,\n  showSaveDialog: require('./save-dialog').saveDialog,\n  showSaveDialogSync: require('./save-dialog').saveDialogSync,\n  showMessageBox: require('./message-box').messageBox,\n  showMessageBoxSync: require('./message-box').messageBoxSync,\n  // showErrorBox: require('./error-box'),\n}\n","/* eslint-disable no-not-accumulator-reassign/no-not-accumulator-reassign */\nvar utils = require('./utils')\n\nvar typeMap = {\n  none: 0,\n  info: 1,\n  error: 2,\n  question: 1,\n  warning: 2,\n}\n\nfunction setupOptions(document, options) {\n  if (\n    !document ||\n    (typeof document.isKindOfClass !== 'function' && !document.sketchObject)\n  ) {\n    options = document\n    document = undefined\n  } else if (document.sketchObject) {\n    document = document.sketchObject\n  }\n  if (!options) {\n    options = {}\n  }\n\n  var dialog = NSAlert.alloc().init()\n\n  if (options.type) {\n    dialog.alertStyle = typeMap[options.type] || 0\n  }\n\n  if (options.buttons && options.buttons.length) {\n    options.buttons.forEach(function addButton(button) {\n      dialog.addButtonWithTitle(\n        options.normalizeAccessKeys ? button.replace(/&/g, '') : button\n      )\n      // TODO: add keyboard shortcut if options.normalizeAccessKeys\n    })\n  }\n\n  if (typeof options.defaultId !== 'undefined') {\n    var buttons = dialog.buttons()\n    if (options.defaultId < buttons.length) {\n      // Focus the button at defaultId if the user opted to do so.\n      // The first button added gets set as the default selected.\n      // So remove that default, and make the requested button the default.\n      buttons[0].setKeyEquivalent('')\n      buttons[options.defaultId].setKeyEquivalent('\\r')\n    }\n  }\n\n  if (options.title) {\n    // not shown on macOS\n  }\n\n  if (options.message) {\n    dialog.messageText = options.message\n  }\n\n  if (options.detail) {\n    dialog.informativeText = options.detail\n  }\n\n  if (options.checkboxLabel) {\n    dialog.showsSuppressionButton = true\n    dialog.suppressionButton().title = options.checkboxLabel\n\n    if (typeof options.checkboxChecked !== 'undefined') {\n      dialog.suppressionButton().state = options.checkboxChecked\n        ? NSOnState\n        : NSOffState\n    }\n  }\n\n  if (options.icon) {\n    if (typeof options.icon === 'string') {\n      options.icon = NSImage.alloc().initWithContentsOfFile(options.icon)\n    }\n    dialog.icon = options.icon\n  } else if (\n    typeof __command !== 'undefined' &&\n    __command.pluginBundle() &&\n    __command.pluginBundle().icon()\n  ) {\n    dialog.icon = __command.pluginBundle().icon()\n  } else {\n    var icon = NSImage.imageNamed('plugins')\n    if (icon) {\n      dialog.icon = icon\n    }\n  }\n\n  return {\n    document: document,\n    options: options,\n    dialog: dialog,\n  }\n}\n\n// https://github.com/electron/electron/blob/master/docs/api/dialog.md#dialogshowmessageboxbrowserwindow-options\nmodule.exports.messageBox = function messageBox(document, options) {\n  var setup = setupOptions(document, options)\n\n  return utils.runDialog(\n    setup.dialog,\n    function getResult(_dialog, returnCode) {\n      return {\n        response:\n          setup.options.buttons && setup.options.buttons.length\n            ? Number(returnCode) - 1000\n            : Number(returnCode),\n        checkboxChecked: _dialog.suppressionButton().state() == NSOnState,\n      }\n    },\n    setup.document\n  )\n}\n\n// https://github.com/electron/electron/blob/master/docs/api/dialog.md#dialogshowmessageboxsyncbrowserwindow-options\nmodule.exports.messageBoxSync = function messageBoxSync(document, options) {\n  var setup = setupOptions(document, options)\n\n  return utils.runDialogSync(\n    setup.dialog,\n    function getResult(_dialog, returnCode) {\n      return setup.options.buttons && setup.options.buttons.length\n        ? Number(returnCode) - 1000\n        : Number(returnCode)\n    },\n    setup.document\n  )\n}\n","/* eslint-disable no-not-accumulator-reassign/no-not-accumulator-reassign */\nvar utils = require('./utils')\n\nfunction setupOptions(document, options) {\n  if (\n    !document ||\n    (typeof document.isKindOfClass !== 'function' && !document.sketchObject)\n  ) {\n    options = document\n    document = undefined\n  }\n  if (!options) {\n    options = {}\n  }\n\n  var dialog = NSOpenPanel.openPanel()\n\n  if (options.title) {\n    dialog.title = options.title\n  }\n\n  if (options.defaultPath) {\n    dialog.setDirectoryURL(utils.getURL(options.defaultPath))\n  }\n\n  if (options.buttonLabel) {\n    dialog.prompt = options.buttonLabel\n  }\n\n  if (options.filters && options.filters.length) {\n    var exts = []\n    options.filters.forEach(function setFilter(filter) {\n      filter.extensions.forEach(function setExtension(ext) {\n        exts.push(ext)\n      })\n    })\n\n    dialog.allowedFileTypes = exts\n  }\n\n  var hasProperty =\n    Array.isArray(options.properties) && options.properties.length > 0\n  dialog.canChooseFiles =\n    hasProperty && options.properties.indexOf('openFile') !== -1\n  dialog.canChooseDirectories =\n    hasProperty && options.properties.indexOf('openDirectory') !== -1\n  dialog.allowsMultipleSelection =\n    hasProperty && options.properties.indexOf('multiSelections') !== -1\n  dialog.showsHiddenFiles =\n    hasProperty && options.properties.indexOf('showHiddenFiles') !== -1\n  dialog.canCreateDirectories =\n    hasProperty && options.properties.indexOf('createDirectory') !== -1\n  dialog.resolvesAliases =\n    !hasProperty || options.properties.indexOf('noResolveAliases') === -1\n  dialog.treatsFilePackagesAsDirectories =\n    hasProperty && options.properties.indexOf('treatPackageAsDirectory') !== -1\n\n  if (options.message) {\n    dialog.message = options.message\n  }\n\n  return {\n    document: document,\n    options: options,\n    dialog: dialog,\n  }\n}\n\n// https://github.com/electron/electron/blob/master/docs/api/dialog.md#dialogshowopendialogbrowserwindow-options\nmodule.exports.openDialog = function openDialog(document, options) {\n  var setup = setupOptions(document, options)\n\n  return utils.runDialog(\n    setup.dialog,\n    function getResult(_dialog, returnCode) {\n      if (returnCode != NSOKButton) {\n        return {\n          canceled: true,\n          filePaths: [],\n        }\n      }\n      var result = []\n      var urls = _dialog.URLs()\n      for (var k = 0; k < urls.length; k += 1) {\n        result.push(String(urls[k].path()))\n      }\n      return {\n        canceled: false,\n        filePaths: result,\n      }\n    },\n    setup.document\n  )\n}\n\n// https://github.com/electron/electron/blob/master/docs/api/dialog.md#dialogshowopendialogsyncbrowserwindow-options\nmodule.exports.openDialogSync = function openDialogSync(document, options) {\n  var setup = setupOptions(document, options)\n\n  return utils.runDialogSync(\n    setup.dialog,\n    function getResult(_dialog, returnCode) {\n      if (returnCode != NSOKButton) {\n        return []\n      }\n      var result = []\n      var urls = _dialog.URLs()\n      for (var k = 0; k < urls.length; k += 1) {\n        result.push(String(urls[k].path()))\n      }\n      return result\n    },\n    setup.document\n  )\n}\n","/* eslint-disable no-not-accumulator-reassign/no-not-accumulator-reassign */\nvar utils = require('./utils')\n\nfunction setupOptions(document, options) {\n  if (\n    !document ||\n    (typeof document.isKindOfClass !== 'function' && !document.sketchObject)\n  ) {\n    options = document\n    document = undefined\n  }\n  if (!options) {\n    options = {}\n  }\n\n  var dialog = NSSavePanel.savePanel()\n\n  if (options.title) {\n    dialog.title = options.title\n  }\n\n  if (options.defaultPath) {\n    // that's a path\n    dialog.setDirectoryURL(utils.getURL(options.defaultPath))\n\n    if (\n      options.defaultPath[0] === '.' ||\n      options.defaultPath[0] === '~' ||\n      options.defaultPath[0] === '/'\n    ) {\n      var parts = options.defaultPath.split('/')\n      if (parts.length > 1 && parts[parts.length - 1]) {\n        dialog.setNameFieldStringValue(parts[parts.length - 1])\n      }\n    } else {\n      dialog.setNameFieldStringValue(options.defaultPath)\n    }\n  }\n\n  if (options.buttonLabel) {\n    dialog.prompt = options.buttonLabel\n  }\n\n  if (options.filters && options.filters.length) {\n    var exts = []\n    options.filters.forEach(function setFilter(filter) {\n      filter.extensions.forEach(function setExtension(ext) {\n        exts.push(ext)\n      })\n    })\n\n    if (dialog.allowedContentTypes) {\n      // Big Sur and newer.\n      dialog.allowedContentTypes = exts.map((ext) => UTType.typeWithFilenameExtension(ext))\n    } else {\n      // Catalina and older.\n      dialog.allowedFileTypes = exts\n    }\n  }\n\n  if (options.message) {\n    dialog.message = options.message\n  }\n\n  if (options.nameFieldLabel) {\n    dialog.nameFieldLabel = options.nameFieldLabel\n  }\n\n  if (options.showsTagField) {\n    dialog.showsTagField = options.showsTagField\n  }\n\n  return {\n    document: document,\n    options: options,\n    dialog: dialog,\n  }\n}\n\n// https://github.com/electron/electron/blob/master/docs/api/dialog.md#dialogshowsavedialogbrowserwindow-options\nmodule.exports.saveDialog = function saveDialog(document, options) {\n  var setup = setupOptions(document, options)\n\n  return utils.runDialog(\n    setup.dialog,\n    function getResult(_dialog, returnCode) {\n      return {\n        canceled: returnCode != NSOKButton,\n        filePath:\n          returnCode == NSOKButton ? String(_dialog.URL().path()) : undefined,\n      }\n    },\n    setup.document\n  )\n}\n\n// https://github.com/electron/electron/blob/master/docs/api/dialog.md#dialogshowsavedialogsyncbrowserwindow-options\nmodule.exports.saveDialogSync = function saveDialogSync(document, options) {\n  var setup = setupOptions(document, options)\n\n  return utils.runDialogSync(\n    setup.dialog,\n    function getResult(_dialog, returnCode) {\n      return returnCode == NSOKButton ? String(_dialog.URL().path()) : undefined\n    },\n    setup.document\n  )\n}\n","module.exports.getURL = function getURL(path) {\n  return NSURL.URLWithString(\n    String(\n      NSString.stringWithString(path).stringByExpandingTildeInPath()\n    ).replace(/ /g, '%20')\n  )\n}\n\nmodule.exports.runDialog = function runDialog(dialog, getResult, document) {\n  if (!document) {\n    var returnCode = dialog.runModal()\n    return Promise.resolve(getResult(dialog, returnCode))\n  }\n\n  var fiber = coscript.createFiber()\n\n  var window = (document.sketchObject || document).documentWindow()\n\n  return new Promise(function p(resolve, reject) {\n    dialog.beginSheetModalForWindow_completionHandler(\n      window,\n      __mocha__.createBlock_function('v16@?0q8', function onCompletion(\n        _returnCode\n      ) {\n        try {\n          resolve(getResult(dialog, _returnCode))\n        } catch (err) {\n          reject(err)\n        }\n        NSApp.endSheet(dialog)\n        if (fiber) {\n          fiber.cleanup()\n        } else {\n          coscript.shouldKeepAround = false\n        }\n      })\n    )\n  })\n}\n\nmodule.exports.runDialogSync = function runDialog(dialog, getResult, document) {\n  var returnCode\n\n  if (!document) {\n    returnCode = dialog.runModal()\n    return getResult(dialog, returnCode)\n  }\n\n  var window = (document.sketchObject || document).documentWindow()\n\n  dialog.beginSheetModalForWindow_completionHandler(\n    window,\n    __mocha__.createBlock_function('v16@?0q8', function onCompletion(\n      _returnCode\n    ) {\n      NSApp.stopModalWithCode(_returnCode)\n    })\n  )\n\n  returnCode = NSApp.runModalForWindow(window)\n  NSApp.endSheet(dialog)\n  return getResult(dialog, returnCode)\n}\n","// TODO: async. Should probably be done with NSFileHandle and some notifications\n// TODO: file descriptor. Needs to be done with NSFileHandle\nvar Buffer = require(\"buffer\").Buffer;\nvar utils = require(\"./utils\");\nvar parseStat = utils.parseStat;\nvar fsError = utils.fsError;\nvar fsErrorForPath = utils.fsErrorForPath;\nvar encodingFromOptions = utils.encodingFromOptions;\nvar NOT_IMPLEMENTED = utils.NOT_IMPLEMENTED;\n\nmodule.exports.constants = {\n  F_OK: 0,\n  R_OK: 4,\n  W_OK: 2,\n  X_OK: 1,\n};\n\nmodule.exports.access = NOT_IMPLEMENTED(\"access\");\n\nmodule.exports.accessSync = function (path, mode) {\n  mode = mode | 0;\n  var fileManager = NSFileManager.defaultManager();\n\n  switch (mode) {\n    case 0:\n      canAccess = module.exports.existsSync(path);\n      break;\n    case 1:\n      canAccess = Boolean(Number(fileManager.isExecutableFileAtPath(path)));\n      break;\n    case 2:\n      canAccess = Boolean(Number(fileManager.isWritableFileAtPath(path)));\n      break;\n    case 3:\n      canAccess =\n        Boolean(Number(fileManager.isExecutableFileAtPath(path))) &&\n        Boolean(Number(fileManager.isWritableFileAtPath(path)));\n      break;\n    case 4:\n      canAccess = Boolean(Number(fileManager.isReadableFileAtPath(path)));\n      break;\n    case 5:\n      canAccess =\n        Boolean(Number(fileManager.isReadableFileAtPath(path))) &&\n        Boolean(Number(fileManager.isExecutableFileAtPath(path)));\n      break;\n    case 6:\n      canAccess =\n        Boolean(Number(fileManager.isReadableFileAtPath(path))) &&\n        Boolean(Number(fileManager.isWritableFileAtPath(path)));\n      break;\n    case 7:\n      canAccess =\n        Boolean(Number(fileManager.isReadableFileAtPath(path))) &&\n        Boolean(Number(fileManager.isWritableFileAtPath(path))) &&\n        Boolean(Number(fileManager.isExecutableFileAtPath(path)));\n      break;\n  }\n\n  if (!canAccess) {\n    throw new Error(\"Can't access \" + String(path));\n  }\n};\n\nmodule.exports.appendFile = NOT_IMPLEMENTED(\"appendFile\");\n\nmodule.exports.appendFileSync = function (file, data, options) {\n  if (!module.exports.existsSync(file)) {\n    return module.exports.writeFileSync(file, data, options);\n  }\n\n  var handle = NSFileHandle.fileHandleForWritingAtPath(file);\n  handle.seekToEndOfFile();\n\n  var encoding = encodingFromOptions(options, \"utf8\");\n\n  var nsdata = Buffer.from(\n    data,\n    encoding === \"NSData\" || encoding === \"buffer\" ? undefined : encoding\n  ).toNSData();\n\n  handle.writeData(nsdata);\n};\n\nmodule.exports.chmod = NOT_IMPLEMENTED(\"chmod\");\n\nmodule.exports.chmodSync = function (path, mode) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  fileManager.setAttributes_ofItemAtPath_error(\n    {\n      NSFilePosixPermissions: mode,\n    },\n    path,\n    err\n  );\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, undefined, err.value());\n  }\n};\n\nmodule.exports.chown = NOT_IMPLEMENTED(\"chown\");\nmodule.exports.chownSync = NOT_IMPLEMENTED(\"chownSync\");\n\nmodule.exports.close = NOT_IMPLEMENTED(\"close\");\nmodule.exports.closeSync = NOT_IMPLEMENTED(\"closeSync\");\n\nmodule.exports.copyFile = NOT_IMPLEMENTED(\"copyFile\");\n\nmodule.exports.copyFileSync = function (path, dest, flags) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  fileManager.copyItemAtPath_toPath_error(path, dest, err);\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, false, err.value());\n  }\n};\n\nmodule.exports.createReadStream = NOT_IMPLEMENTED(\"createReadStream\");\nmodule.exports.createWriteStream = NOT_IMPLEMENTED(\"createWriteStream\");\n\nmodule.exports.exists = NOT_IMPLEMENTED(\"exists\");\n\nmodule.exports.existsSync = function (path) {\n  var fileManager = NSFileManager.defaultManager();\n  return Boolean(Number(fileManager.fileExistsAtPath(path)));\n};\n\nmodule.exports.fchmod = NOT_IMPLEMENTED(\"fchmod\");\nmodule.exports.fchmodSync = NOT_IMPLEMENTED(\"fchmodSync\");\nmodule.exports.fchown = NOT_IMPLEMENTED(\"fchown\");\nmodule.exports.fchownSync = NOT_IMPLEMENTED(\"fchownSync\");\nmodule.exports.fdatasync = NOT_IMPLEMENTED(\"fdatasync\");\nmodule.exports.fdatasyncSync = NOT_IMPLEMENTED(\"fdatasyncSync\");\nmodule.exports.fstat = NOT_IMPLEMENTED(\"fstat\");\nmodule.exports.fstatSync = NOT_IMPLEMENTED(\"fstatSync\");\nmodule.exports.fsync = NOT_IMPLEMENTED(\"fsync\");\nmodule.exports.fsyncSync = NOT_IMPLEMENTED(\"fsyncSync\");\nmodule.exports.ftruncate = NOT_IMPLEMENTED(\"ftruncate\");\nmodule.exports.ftruncateSync = NOT_IMPLEMENTED(\"ftruncateSync\");\nmodule.exports.futimes = NOT_IMPLEMENTED(\"futimes\");\nmodule.exports.futimesSync = NOT_IMPLEMENTED(\"futimesSync\");\n\nmodule.exports.lchmod = NOT_IMPLEMENTED(\"lchmod\");\nmodule.exports.lchmodSync = NOT_IMPLEMENTED(\"lchmodSync\");\nmodule.exports.lchown = NOT_IMPLEMENTED(\"lchown\");\nmodule.exports.lchownSync = NOT_IMPLEMENTED(\"lchownSync\");\n\nmodule.exports.link = NOT_IMPLEMENTED(\"link\");\n\nmodule.exports.linkSync = function (existingPath, newPath) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  fileManager.linkItemAtPath_toPath_error(existingPath, newPath, err);\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(existingPath, undefined, err.value());\n  }\n};\n\nmodule.exports.lstat = NOT_IMPLEMENTED(\"lstat\");\n\nmodule.exports.lstatSync = function (path) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  var result = fileManager.attributesOfItemAtPath_error(path, err);\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, undefined, err.value());\n  }\n\n  return parseStat(result);\n};\n\nmodule.exports.mkdir = NOT_IMPLEMENTED(\"mkdir\");\n\nmodule.exports.mkdirSync = function (path, options) {\n  var mode = 0o777;\n  var recursive = false;\n  if (options && options.mode) {\n    mode = options.mode;\n  }\n  if (options && options.recursive) {\n    recursive = options.recursive;\n  }\n  if (typeof options === \"number\") {\n    mode = options;\n  }\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  fileManager.createDirectoryAtPath_withIntermediateDirectories_attributes_error(\n    path,\n    recursive,\n    {\n      NSFilePosixPermissions: mode,\n    },\n    err\n  );\n\n  if (err.value() !== null) {\n    throw new Error(err.value());\n  }\n};\n\nmodule.exports.mkdtemp = NOT_IMPLEMENTED(\"mkdtemp\");\n\nmodule.exports.mkdtempSync = function (path) {\n  function makeid() {\n    var text = \"\";\n    var possible =\n      \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n\n    for (var i = 0; i < 6; i++)\n      text += possible.charAt(Math.floor(Math.random() * possible.length));\n\n    return text;\n  }\n  var tempPath = path + makeid();\n  module.exports.mkdirSync(tempPath);\n  return tempPath;\n};\n\nmodule.exports.open = NOT_IMPLEMENTED(\"open\");\nmodule.exports.openSync = NOT_IMPLEMENTED(\"openSync\");\n\nmodule.exports.read = NOT_IMPLEMENTED(\"read\");\n\nmodule.exports.readdir = NOT_IMPLEMENTED(\"readdir\");\n\nmodule.exports.readdirSync = function (path, options) {\n  var encoding = encodingFromOptions(options, \"utf8\");\n  var fileManager = NSFileManager.defaultManager();\n  var paths = fileManager.subpathsAtPath(path);\n  var arr = [];\n  for (var i = 0; i < paths.length; i++) {\n    var pathName = paths[i];\n    arr.push(encoding === \"buffer\" ? Buffer.from(pathName) : String(pathName));\n  }\n  return arr;\n};\n\nmodule.exports.readFile = NOT_IMPLEMENTED(\"readFile\");\n\nmodule.exports.readFileSync = function (path, options) {\n  var encoding = encodingFromOptions(options, \"buffer\");\n  var fileManager = NSFileManager.defaultManager();\n  var data = fileManager.contentsAtPath(path);\n  if (!data) {\n    throw fsErrorForPath(path, false);\n  }\n\n  var buffer = Buffer.from(data);\n\n  if (encoding === \"buffer\") {\n    return buffer;\n  } else if (encoding === \"NSData\") {\n    return buffer.toNSData();\n  } else {\n    return buffer.toString(encoding);\n  }\n};\n\nmodule.exports.readlink = NOT_IMPLEMENTED(\"readlink\");\n\nmodule.exports.readlinkSync = function (path) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  var result = fileManager.destinationOfSymbolicLinkAtPath_error(path, err);\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, undefined, err.value());\n  }\n\n  return String(result);\n};\n\nmodule.exports.readSync = NOT_IMPLEMENTED(\"readSync\");\n\nmodule.exports.realpath = NOT_IMPLEMENTED(\"realpath\");\nmodule.exports.realpath.native = NOT_IMPLEMENTED(\"realpath.native\");\n\nmodule.exports.realpathSync = function (path) {\n  return String(\n    NSString.stringWithString(path).stringByResolvingSymlinksInPath()\n  );\n};\n\nmodule.exports.realpathSync.native = NOT_IMPLEMENTED(\"realpathSync.native\");\n\nmodule.exports.rename = NOT_IMPLEMENTED(\"rename\");\n\nmodule.exports.renameSync = function (oldPath, newPath) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  fileManager.moveItemAtPath_toPath_error(oldPath, newPath, err);\n\n  var error = err.value();\n\n  if (error !== null) {\n    // if there is already a file, we need to overwrite it\n    if (\n      String(error.domain()) === \"NSCocoaErrorDomain\" &&\n      Number(error.code()) === 516\n    ) {\n      var err2 = MOPointer.alloc().init();\n      fileManager.replaceItemAtURL_withItemAtURL_backupItemName_options_resultingItemURL_error(\n        NSURL.fileURLWithPath(newPath),\n        NSURL.fileURLWithPath(oldPath),\n        null,\n        NSFileManagerItemReplacementUsingNewMetadataOnly,\n        null,\n        err2\n      );\n      if (err2.value() !== null) {\n        throw fsErrorForPath(oldPath, undefined, err2.value());\n      }\n    } else {\n      throw fsErrorForPath(oldPath, undefined, error);\n    }\n  }\n};\n\nmodule.exports.rmdir = NOT_IMPLEMENTED(\"rmdir\");\n\nmodule.exports.rmdirSync = function (path) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  var isDirectory = module.exports.lstatSync(path).isDirectory();\n  if (!isDirectory) {\n    throw fsError(\"ENOTDIR\", {\n      path: path,\n      syscall: \"rmdir\",\n    });\n  }\n  fileManager.removeItemAtPath_error(path, err);\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, true, err.value(), \"rmdir\");\n  }\n};\n\nmodule.exports.stat = NOT_IMPLEMENTED(\"stat\");\n\n// the only difference with lstat is that we resolve symlinks\n//\n// > lstat() is identical to stat(), except that if pathname is a symbolic\n// > link, then it returns information about the link itself, not the file\n// > that it refers to.\n// http://man7.org/linux/man-pages/man2/lstat.2.html\nmodule.exports.statSync = function (path) {\n  return module.exports.lstatSync(module.exports.realpathSync(path));\n};\n\nmodule.exports.symlink = NOT_IMPLEMENTED(\"symlink\");\n\nmodule.exports.symlinkSync = function (target, path) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  var result = fileManager.createSymbolicLinkAtPath_withDestinationPath_error(\n    path,\n    target,\n    err\n  );\n\n  if (err.value() !== null) {\n    throw new Error(err.value());\n  }\n};\n\nmodule.exports.truncate = NOT_IMPLEMENTED(\"truncate\");\n\nmodule.exports.truncateSync = function (path, len) {\n  var hFile = NSFileHandle.fileHandleForUpdatingAtPath(sFilePath);\n  hFile.truncateFileAtOffset(len || 0);\n  hFile.closeFile();\n};\n\nmodule.exports.unlink = NOT_IMPLEMENTED(\"unlink\");\n\nmodule.exports.unlinkSync = function (path) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  var isDirectory = module.exports.lstatSync(path).isDirectory();\n  if (isDirectory) {\n    throw fsError(\"EPERM\", {\n      path: path,\n      syscall: \"unlink\",\n    });\n  }\n  var result = fileManager.removeItemAtPath_error(path, err);\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, false, err.value());\n  }\n};\n\nmodule.exports.unwatchFile = NOT_IMPLEMENTED(\"unwatchFile\");\n\nmodule.exports.utimes = NOT_IMPLEMENTED(\"utimes\");\n\nmodule.exports.utimesSync = function (path, aTime, mTime) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  var result = fileManager.setAttributes_ofItemAtPath_error(\n    {\n      NSFileModificationDate: aTime,\n    },\n    path,\n    err\n  );\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, undefined, err.value());\n  }\n};\n\nmodule.exports.watch = NOT_IMPLEMENTED(\"watch\");\nmodule.exports.watchFile = NOT_IMPLEMENTED(\"watchFile\");\n\nmodule.exports.write = NOT_IMPLEMENTED(\"write\");\n\nmodule.exports.writeFile = NOT_IMPLEMENTED(\"writeFile\");\n\nmodule.exports.writeFileSync = function (path, data, options) {\n  var encoding = encodingFromOptions(options, \"utf8\");\n\n  var nsdata = Buffer.from(\n    data,\n    encoding === \"NSData\" || encoding === \"buffer\" ? undefined : encoding\n  ).toNSData();\n\n  nsdata.writeToFile_atomically(path, true);\n};\n\nmodule.exports.writeSync = NOT_IMPLEMENTED(\"writeSync\");\n","module.exports.parseStat = function parseStat(result) {\n  return {\n    dev: String(result.NSFileDeviceIdentifier),\n    // ino: 48064969, The file system specific \"Inode\" number for the file.\n    mode: result.NSFileType | result.NSFilePosixPermissions,\n    nlink: Number(result.NSFileReferenceCount),\n    uid: String(result.NSFileOwnerAccountID),\n    gid: String(result.NSFileGroupOwnerAccountID),\n    // rdev: 0, A numeric device identifier if the file is considered \"special\".\n    size: Number(result.NSFileSize),\n    // blksize: 4096, The file system block size for i/o operations.\n    // blocks: 8, The number of blocks allocated for this file.\n    atimeMs:\n      Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000,\n    mtimeMs:\n      Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000,\n    ctimeMs:\n      Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000,\n    birthtimeMs:\n      Number(result.NSFileCreationDate.timeIntervalSince1970()) * 1000,\n    atime: new Date(\n      Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000 + 0.5\n    ), // the 0.5 comes from the node source. Not sure why it's added but in doubt...\n    mtime: new Date(\n      Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000 + 0.5\n    ),\n    ctime: new Date(\n      Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000 + 0.5\n    ),\n    birthtime: new Date(\n      Number(result.NSFileCreationDate.timeIntervalSince1970()) * 1000 + 0.5\n    ),\n    isBlockDevice: function () {\n      return result.NSFileType === NSFileTypeBlockSpecial;\n    },\n    isCharacterDevice: function () {\n      return result.NSFileType === NSFileTypeCharacterSpecial;\n    },\n    isDirectory: function () {\n      return result.NSFileType === NSFileTypeDirectory;\n    },\n    isFIFO: function () {\n      return false;\n    },\n    isFile: function () {\n      return result.NSFileType === NSFileTypeRegular;\n    },\n    isSocket: function () {\n      return result.NSFileType === NSFileTypeSocket;\n    },\n    isSymbolicLink: function () {\n      return result.NSFileType === NSFileTypeSymbolicLink;\n    },\n  };\n};\n\nvar ERRORS = {\n  EPERM: {\n    message: \"operation not permitted\",\n    errno: -1,\n  },\n  ENOENT: {\n    message: \"no such file or directory\",\n    errno: -2,\n  },\n  EACCES: {\n    message: \"permission denied\",\n    errno: -13,\n  },\n  ENOTDIR: {\n    message: \"not a directory\",\n    errno: -20,\n  },\n  EISDIR: {\n    message: \"illegal operation on a directory\",\n    errno: -21,\n  },\n};\n\nfunction fsError(code, options) {\n  var error = new Error(\n    code +\n      \": \" +\n      ERRORS[code].message +\n      \", \" +\n      (options.syscall || \"\") +\n      (options.path ? \" '\" + options.path + \"'\" : \"\")\n  );\n\n  Object.keys(options).forEach(function (k) {\n    error[k] = options[k];\n  });\n\n  error.code = code;\n  error.errno = ERRORS[code].errno;\n\n  return error;\n}\n\nmodule.exports.fsError = fsError;\n\nmodule.exports.fsErrorForPath = function fsErrorForPath(\n  path,\n  shouldBeDir,\n  err,\n  syscall\n) {\n  var fileManager = NSFileManager.defaultManager();\n  var doesExist = fileManager.fileExistsAtPath(path);\n  if (!doesExist) {\n    return fsError(\"ENOENT\", {\n      path: path,\n      syscall: syscall || \"open\",\n    });\n  }\n  var isReadable = fileManager.isReadableFileAtPath(path);\n  if (!isReadable) {\n    return fsError(\"EACCES\", {\n      path: path,\n      syscall: syscall || \"open\",\n    });\n  }\n  if (typeof shouldBeDir !== \"undefined\") {\n    var isDirectory = require(\"./index\").lstatSync(path).isDirectory();\n    if (isDirectory && !shouldBeDir) {\n      return fsError(\"EISDIR\", {\n        path: path,\n        syscall: syscall || \"read\",\n      });\n    } else if (!isDirectory && shouldBeDir) {\n      return fsError(\"ENOTDIR\", {\n        path: path,\n        syscall: syscall || \"read\",\n      });\n    }\n  }\n  return new Error(err || \"Unknown error while manipulating \" + path);\n};\n\nmodule.exports.encodingFromOptions = function encodingFromOptions(\n  options,\n  defaultValue\n) {\n  return options && options.encoding\n    ? String(options.encoding)\n    : options\n    ? String(options)\n    : defaultValue;\n};\n\nmodule.exports.NOT_IMPLEMENTED = function NOT_IMPLEMENTED(name) {\n  return function () {\n    throw new Error(\n      \"fs.\" +\n        name +\n        \" is not implemented yet. If you feel like implementing it, any contribution will be gladly accepted on https://github.com/skpm/fs\"\n    );\n  };\n};\n","/* from https://github.com/taylorhakes/promise-polyfill */\n\nfunction promiseFinally(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      return constructor.resolve(callback()).then(function() {\n        return constructor.reject(reason);\n      });\n    }\n  );\n}\n\nfunction noop() {}\n\n/**\n * @constructor\n * @param {Function} fn\n */\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError(\"Promises must be constructed via new\");\n  if (typeof fn !== \"function\") throw new TypeError(\"not a function\");\n  /** @type {!number} */\n  this._state = 0;\n  /** @type {!boolean} */\n  this._handled = false;\n  /** @type {Promise|undefined} */\n  this._value = undefined;\n  /** @type {!Array<!Function>} */\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError(\"A promise cannot be resolved with itself.\");\n    if (\n      newValue &&\n      (typeof newValue === \"object\" || typeof newValue === \"function\")\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === \"function\") {\n        doResolve(then.bind(newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value, self);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\n/**\n * @constructor\n */\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === \"function\" ? onFulfilled : null;\n  this.onRejected = typeof onRejected === \"function\" ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) {\n          Promise._multipleResolvesFn(\"resolve\", self, value);\n          return;\n        }\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) {\n          Promise._multipleResolvesFn(\"reject\", self, reason);\n          return;\n        }\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) {\n      Promise._multipleResolvesFn(\"reject\", self, ex);\n      return;\n    }\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype[\"catch\"] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  // @ts-ignore\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype[\"finally\"] = promiseFinally;\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!Array.isArray(arr)) {\n      return reject(new TypeError(\"Promise.all accepts an array\"));\n    }\n\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === \"object\" || typeof val === \"function\")) {\n          var then = val.then;\n          if (typeof then === \"function\") {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.resolve = function(value) {\n  if (value && typeof value === \"object\" && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!Array.isArray(arr)) {\n      return reject(new TypeError(\"Promise.race accepts an array\"));\n    }\n\n    for (var i = 0, len = arr.length; i < len; i++) {\n      Promise.resolve(arr[i]).then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn = setImmediate;\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err, promise) {\n  if (\n    typeof process !== \"undefined\" &&\n    process.listenerCount &&\n    (process.listenerCount(\"unhandledRejection\") ||\n      process.listenerCount(\"uncaughtException\"))\n  ) {\n    process.emit(\"unhandledRejection\", err, promise);\n    process.emit(\"uncaughtException\", err, \"unhandledRejection\");\n  } else if (typeof console !== \"undefined\" && console) {\n    console.warn(\"Possible Unhandled Promise Rejection:\", err);\n  }\n};\n\nPromise._multipleResolvesFn = function _multipleResolvesFn(\n  type,\n  promise,\n  value\n) {\n  if (typeof process !== \"undefined\" && process.emit) {\n    process.emit(\"multipleResolves\", type, promise, value);\n  }\n};\n\nmodule.exports = Promise;\n","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/1ebbd3084ce348705d20ad4f97ac0366.mjs\";","let excelDivider = ' / '\nlet sketchSymbolDivider = '/'\nlet artboardPrefix = 'ARTBOARD: '\nlet translateLayerPrefix = '#'\n\nmodule.exports = {\n  excelDivider,\n  sketchSymbolDivider,\n  artboardPrefix,\n  translateLayerPrefix\n}\n","import sketch from 'sketch'\nimport fs from '@skpm/fs'\nimport dialog from '@skpm/dialog'\n\nvar constants = require('./constants')\nvar UI = require('sketch/ui')\nvar path = require('path')\nvar Settings = require('sketch/settings')\n// var csv = require('csvtojson')\nvar XLSX = require('xlsx')\n\nvar document = sketch.getSelectedDocument()\n\nvar contentDictionary = {}\nvar languageOptions = []\nvar selectedLanguage\n\nexport function syncCurrentPage (context) {\n  console.log('syncCurrentPage')\n  if (contentDocumentExists()) {\n    console.log('contentDocumentExists true')\n    var contentFile = Settings.documentSettingForKey(document, 'excelTranslateContentFile')\n    loadData(contentFile)\n    populatePage()\n    context.document.reloadInspector()\n  } else {\n    console.log('Content file not found.')\n    sketch.UI.message('Content file not found.')\n  }\n}\n\nexport function syncAllPages (context) {\n  console.log('syncAllPages')\n  if (contentDocumentExists() && document.pages) {\n    var contentFile = Settings.documentSettingForKey(document, 'excelTranslateContentFile')\n    loadData(contentFile)\n    for (let page of document.pages) {\n      // Don't add symbols page\n      if (page.name !== 'Symbols') {\n        populatePage(page)\n      }\n    }\n    context.document.reloadInspector()\n  } else {\n    console.log('Document contains no pages, or content file not found.')\n    sketch.UI.message('Document contains no pages, or content file not found.')\n  }\n}\n\nexport function selectContentFile (context) {\n  console.log('selectContentFile')\n  var filePaths = dialog.showOpenDialog({\n    properties: ['openFile'],\n    defaultPath: 'directory',\n    filters: [{\n      name: 'Excel or CSV',\n      extensions: ['xlsx', 'xls', 'csv']\n    }]\n  })\n  if (filePaths.length) {\n    var contentFile = filePaths[0]\n    console.log('set contentFile: ', contentFile)\n    // set as document key\n    Settings.setDocumentSettingForKey(document, 'excelTranslateContentFile', contentFile)\n    console.log('DocumentKey: ', Settings.documentSettingForKey(document, 'excelTranslateContentFile'))\n    sketch.UI.message('Content file set! Now you can translate the current page or all pages.')\n  } else {\n    console.log('no file selected')\n    sketch.UI.message('No file selected. Select Excel or CSV file to continue. Generate a file if you don\\'t have one.')\n  }\n}\n\nfunction loadData (contentFile) {\n  // check filetype\n  let fileType = path.extname(contentFile)\n  switch (fileType.toLowerCase()) {\n    case '.csv':\n      console.log('csv')\n      // TODO: Support csv files\n      // loadCSVData(contentFile)\n      break\n    // eslint-disable-next-line no-sequences\n    case '.xls', '.xlsx':\n      console.log('Excel')\n      loadExcelData(contentFile)\n      break\n    default:\n      console.log('File format not supported.')\n      sketch.UI.message('File format not supported.')\n  }\n}\n\nfunction contentDocumentExists () {\n  var contentFile = Settings.documentSettingForKey(document, 'excelTranslateContentFile')\n  console.log('contentFile: ', contentFile)\n  if (contentFile) {\n    if (fs.existsSync(contentFile)) {\n      console.log('file exists: ', contentFile)\n      return true\n    }\n  } else {\n    console.log('No content file.')\n    sketch.UI.message('Select a content document first.')\n    return false\n  }\n}\n\nfunction showLanguageSelectionPopup (languageOptions) {\n  let contentFile = Settings.documentSettingForKey(document, 'excelTranslateContentFile')\n  let contentFileName = path.basename(contentFile)\n  UI.getInputFromUser(\n    `Sync to language?\\n\\nContent file:\\n${contentFileName}`,\n    {\n      type: UI.INPUT_TYPE.selection,\n      possibleValues: languageOptions\n    },\n    (err, value) => {\n      if (err) {\n        // most likely the user canceled the input\n        return\n      }\n      console.log('selected language')\n      console.log(value)\n      selectedLanguage = value // languageOptions[selection[1]]\n    }\n  )\n}\n\nfunction loadExcelData (contentFile) {\n  let xlsData = fs.readFileSync(contentFile)\n\n  var workbook = XLSX.read(xlsData, {\n    type: 'buffer'\n  })\n  /* Get worksheet. Only support one sheet at the moment. */\n  var firstSheetName = workbook.SheetNames[0]\n  var worksheet = workbook.Sheets[firstSheetName]\n\n  var excelJson = XLSX.utils.sheet_to_json(worksheet, { range: 0, defval: '' })\n  console.log(excelJson)\n  let rowNumber = 2 // Excel row starts at 0, and 1st row is key/value\n\n  // get language options\n  var keyAndLanguageOptions = Object.keys(excelJson[0]) // get language options from first row\n  if (!keyAndLanguageOptions) {\n    console.log('File format not supported. Language options not found')\n    sketch.UI.message('File format not supported. Language options not found')\n    return\n  }\n  console.log(keyAndLanguageOptions)\n  keyAndLanguageOptions.shift() // remove 'key'\n  for (let language of keyAndLanguageOptions) {\n    languageOptions.push(language)\n  }\n\n  // ask for language first so we don't load all language data into the object.\n  console.log('showLanguageSelectionPopup')\n  console.log(languageOptions)\n  showLanguageSelectionPopup(languageOptions)\n  if (!selectedLanguage) {\n    console.log('loadExcelData() aborted. No language selected.')\n    return\n  }\n  var currentArboardName = ''\n\n  for (var row in excelJson) {\n    // Save current artboard\n    if (excelJson[row]['key'].includes(constants.artboardPrefix)) {\n      currentArboardName = excelJson[row]['key']\n      console.log('updated current arboard' + currentArboardName)\n    }\n\n    // skip empty content\n    if (excelJson[row][selectedLanguage]) {\n      console.log('rowNumber: ' + rowNumber, currentArboardName)\n      contentDictionary[String(currentArboardName + '.' + excelJson[row]['key'])] = String(excelJson[row][selectedLanguage])\n    } else {\n      console.log('skipped rowNumber: ' + rowNumber)\n    }\n    rowNumber += 1\n  }\n  console.log(contentDictionary)\n  onComplete()\n}\n\nfunction analyzeLayer (layers) {\n  for (let layer of layers) {\n    console.log(layer.name, layer.type)\n    switch (layer.type) {\n      case String(sketch.Types.Group):\n        console.log('group layer')\n        analyzeLayer(layer.layers)\n        break\n      case String(sketch.Types.SymbolInstance):\n        console.log('symbol layer')\n        updateSymbolLayer(layer)\n        break\n      case String(sketch.Types.Text):\n        console.log('text layer')\n        updateTextLayer(layer)\n        break\n      case String(sketch.Types.Artboard):\n        console.log('artboard layer')\n        analyzeLayer(layer.layers)\n        break\n    }\n  }\n}\n\nfunction populatePage (page) {\n  // abort if no language is chosen\n  if (!selectedLanguage) {\n    console.log('populatePage() aborted. No language selected.')\n    return\n  }\n\n  // Use selected page if no page is set\n  if (!page) {\n    page = document.selectedPage\n    console.log('page: ' + page.name)\n  }\n\n  console.log('page layers: ' + page.layers.length)\n  analyzeLayer(page.layers)\n  onComplete()\n}\n\nfunction onComplete () {\n  console.log('Completed')\n  sketch.UI.message('Completed')\n}\n\nfunction updateTextLayer (layer) {\n  console.log('updateTextLayer')\n\n  // Check for layers outside artboard\n  if (layer.getParentArtboard() === undefined) {\n    console.log('getParentArtboard() undefined')\n  } else {\n    let artboardAndLayerName = constants.artboardPrefix + layer.getParentArtboard().name + '.' + layer.name\n    console.log(artboardAndLayerName)\n    if (contentDictionary[artboardAndLayerName]) {\n      layer.text = contentDictionary[artboardAndLayerName]\n      console.log('new value', layer.name, artboardAndLayerName, layer.text)\n    }\n    console.log('updateTextLayer done')\n  }\n}\n\nfunction updateSymbolLayer (symbol) {\n  console.log('updateSymbolLayer')\n  if (symbol.getParentArtboard() === undefined) {\n    console.log('getParentArtboard() undefined')\n  } else {\n    let artboardAndSymbolName = constants.artboardPrefix + symbol.getParentArtboard().name + '.' + symbol.name\n    console.log(artboardAndSymbolName)\n\n    for (let override of symbol.overrides) {\n      if (override.property === 'stringValue') {\n        let layerNameAndOverride = artboardAndSymbolName + constants.excelDivider + layerNamesFromPath(override.path)\n\n        if (contentDictionary[layerNameAndOverride]) {\n          override.value = contentDictionary[layerNameAndOverride]\n        }\n      }\n    }\n    console.log('updateSymbolLayer done')\n  }\n}\n\n// **********************\n//   Helper methods\n// **********************\n// TODO: function duplicated\nfunction layerNamesFromPath (path) {\n  var layerNames = []\n  let layerIDs = path.split(constants.sketchSymbolDivider)\n  for (let layerID of layerIDs) {\n    let layer = document.getLayerWithID(layerID)\n\n    // TODO: Sketch libraries not supported yet.\n    if (layer) {\n      let layerName = layer.name\n      layerNames.push(layerName)\n    }\n  }\n  return layerNames.join(constants.excelDivider)\n}\n","module.exports = require(\"buffer\");","module.exports = require(\"path\");","module.exports = require(\"sketch\");","module.exports = require(\"sketch/settings\");","module.exports = require(\"sketch/ui\");"],"sourceRoot":""}